# ————————————————————————————————————————————
# Prefix
# ————————————————————————————————————————————
unbind-key C-b                # Unbind the default prefix (Ctrl-b) so it no longer conflicts
unbind-key -n C-l                # clear screen, bitch
set-option -g prefix `        # Make the backtick (`) your new tmux “prefix” key

# ————————————————————————————————————————————
# Last-window toggle (like screen’s CTRL-a a)
# ————————————————————————————————————————————
bind-key ` last-window        # Press `<prefix>` + ` to go back to the previous window

# ————————————————————————————————————————————
# Vim-style pane navigation
# ————————————————————————————————————————————
setw -g mode-keys vi           # Use vi-style keys in copy-mode (hjkl for movement)
bind-key h select-pane -L      # `<prefix>` + h: move focus to the pane on the LEFT
bind-key j select-pane -D      # `<prefix>` + j: move focus to the pane DOWN
bind-key k select-pane -U      # `<prefix>` + k: move focus to the pane UP
bind-key l select-pane -R      # `<prefix>` + l: move focus to the pane on the RIGHT

# Cycle windows with Ctrl-h / Ctrl-l (no prefix)
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind-key -n M-h select-window -t :-  # Alt: go to the “previous” window
bind-key -n M-l select-window -t :+  # Alt: go to the “next” window

# ————————————————————————————————————————————
# Clipboard management
# ————————————————————————————————————————————
# Use OSC 52 escape sequences to copy to the *local* terminal clipboard
set-option -g set-clipboard on

bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "tmux show-buffer | osc52.sh"
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "tmux show-buffer | osc52.sh"

# ————————————————————————————————————————————
# Enter copy-mode and select/copy with vi keys
# ————————————————————————————————————————————
bind-key [ copy-mode                     # `<prefix>` + [: enter copy-mode
bind-key -T copy-mode-vi v send -X begin-selection        # In copy-mode, v → start selection
bind-key -T copy-mode-vi y send -X copy-selection-and-cancel  # In copy-mode, y → copy & exit

# ————————————————————————————————————————————
# Confirm before killing a window
# ————————————————————————————————————————————
bind-key K confirm-before -p "kill-window #W? (y/n)" kill-window
                                  # `<prefix>` + K: prompt before closing current window

# ————————————————————————————————————————————
# Toggle the status bar on/off
# ————————————————————————————————————————————
bind-key b set-option -g status            # `<prefix>` + b: toggle status line visibility

# ————————————————————————————————————————————
# Splitting windows
# ————————————————————————————————————————————
bind-key | split-window -h      # `<prefix>` + |: split current pane horizontally (left/right)
bind-key - split-window -v      # `<prefix>` + -: split current pane vertically (top/bottom)

# ————————————————————————————————————————————
# Mouse support (tmux 2.4+)
# ————————————————————————————————————————————
set-option -g mouse on           # Enable all mouse interactions: clicking, resizing, scrolling

# ————————————————————————————————————————————
# Pane border styling
# ————————————————————————————————————————————
set-option -g pane-active-border-style fg=yellow
                                 # Color the border of the active pane yellow

# ————————————————————————————————————————————
# Status-line left-side content
# ————————————————————————————————————————————
set-option -g status-left '#P'   # Show the current pane index on the left of the status bar

# ————————————————————————————————————————————
# Scrollback & bell notifications
# ————————————————————————————————————————————
set-option -g history-limit 5000 # Allow up to 5,000 lines of scrollback per pane
set-option -g bell-action any    # Ring bell or flash when any window has activity

# ————————————————————————————————————————————
# Window & pane indexing
# ————————————————————————————————————————————
set-option -g base-index 1       # Number windows starting at 1 (not 0)

# ————————————————————————————————————————————
# Automatic window titles
# ————————————————————————————————————————————
set-option -g set-titles on                      # Let tmux change the terminal’s window title
set-option -g set-titles-string "tmux.#I.#W"     # Format for title: tmux.{window_index}.{window_name}

# ————————————————————————————————————————————
# Tabby windows
# ————————————————————————————————————————————
# Put the window list (your "tabs") at the top

# -------------------------------------------------
# Powerline-style tmux theme with CPU + uptime
# -------------------------------------------------
set -g status-position top
set -g status-interval 5          # refresh every 5s
set -g status-bg black
set -g status-fg white
set -g status-justify centre

set -g status-left ''

# Right section: CPU + uptime
# Adjust commands for your OS if needed
set -g status-right-length 100
set -g status-right '#[fg=green,bg=black]#[fg=black,bg=green] #(uptime -p | cut -d " " -f2-) #[fg=yellow,bg=green]#[fg=black,bg=yellow] CPU: #(top -bn1 | grep "Cpu(s)" | awk "{print 100 - \$8\"%\"}") #[default]'

set -g window-status-separator ''

# Inactive tabs
setw -g window-status-format '#[fg=brightblack,bg=black]#[fg=white,bg=black] #I:#W #[fg=black,bg=black]'

# Active tab
setw -g window-status-current-format '#[fg=cyan,bg=black]#[fg=black,bg=cyan,bold] #I:#W #[fg=cyan,bg=black]'

set -g base-index 1

# ————————————————————————————————————————————
# Reload config from ~/.tmux.conf
# ————————————————————————————————————————————
unbind-key r                    # Unbind any existing “r” binding
bind-key r source-file ~/.tmux.conf \; display-message "TMUX config reloaded"
                                # `<prefix>` + r: re-source this file and show a confirm
